import{d as Ae,u as Me,r as d,c as j,o as $e,a as Re,b as n,e,f as _,g as Fe,w as Qe,h as Ve,i as a,t as i,j as p,k as B,F as I,l as N,m as C,v as T,n as H,s as M,p as u,q as r,_ as qe}from"./index-BRWVB6f9.js";const Ue={class:"tables-page"},De={class:"container-fluid py-4"},Ee={class:"card shadow-sm border-0 mb-4 p-3"},Le={class:"card-body"},je={"aria-label":"breadcrumb",class:"mb-3"},Be={class:"breadcrumb mb-0"},Ie={class:"breadcrumb-item"},Ne={class:"row align-items-center"},Pe={class:"col-md-8"},Oe={class:"text-muted mb-0"},ze={class:"badge bg-primary"},We={class:"badge bg-success"},Ge={class:"badge bg-warning"},He={class:"badge bg-danger"},Je={class:"col-md-4 text-end"},Ke=["disabled"],Xe={class:"container-fluid"},Ye={class:"row"},Ze={class:"col-12"},es={class:"card shadow-sm border-0"},ss={class:"card-header bg-white"},ts={class:"row align-items-center"},ls={class:"col-md-8"},os={class:"d-flex gap-2 align-items-center"},as={key:0,class:"btn-group btn-group-sm"},is=["title"],ns=["title"],rs=["title"],ds={class:"d-flex gap-2 ms-auto"},cs=["value"],us={class:"card-body"},vs={key:0,class:"text-center py-5"},bs={key:1,class:"text-center py-5"},ms={key:2,class:"row"},ps={class:"card-header d-flex justify-content-between align-items-center py-2"},ys={class:"d-flex align-items-center"},fs={class:"form-check me-2"},gs=["id","value"],_s={class:"fs-6"},ks={class:"card-body py-2"},ws={class:"row g-2 mb-2"},hs={class:"col-6"},xs={class:"info-item-compact"},Cs={class:"fw-bold"},Ts={class:"col-6"},Ss={class:"info-item-compact"},As={class:"text-truncate"},Ms={key:0,class:"row g-2 mb-2"},$s={class:"col-12"},Rs={class:"current-order-compact"},Fs={class:"fw-bold"},Qs={key:1,class:"row g-2 mb-2"},Vs={class:"col-12"},qs={class:"text-muted text-truncate d-block"},Us={class:"card-footer bg-transparent border-top-0 py-2"},Ds={class:"d-flex gap-1 flex-wrap"},Es=["onClick","title"],Ls=["onClick","title"],js=["onClick","title"],Bs={class:"dropdown"},Is={class:"dropdown-menu dropdown-menu-end"},Ns=["onClick"],Ps=["onClick"],Os=["onClick"],zs=["onClick"],Ws={class:"mt-2"},Gs={class:"text-muted"},Hs={class:"modal-content"},Js={class:"modal-body"},Ks={key:0,class:"alert alert-danger",role:"alert"},Xs={class:"mb-0"},Ys={class:"row g-3"},Zs={class:"col-md-6"},et={class:"col-md-6"},st={class:"col-md-12"},tt=["value"],lt={class:"col-12"},ot={class:"col-12"},at={class:"form-check"},it={class:"d-flex justify-content-end gap-2 mt-4"},nt=["disabled"],rt={class:"modal-content"},dt={class:"modal-body"},ct={key:0,class:"alert alert-danger",role:"alert"},ut={class:"mb-0"},vt={class:"row g-3"},bt={class:"col-md-6"},mt={class:"col-md-6"},pt={class:"col-md-12"},yt=["value"],ft={class:"col-12"},gt={class:"col-12"},_t={class:"form-check"},kt={class:"d-flex justify-content-end gap-2 mt-4"},wt=["disabled"],ht={class:"modal-content"},xt={class:"modal-header"},Ct={class:"modal-title"},Tt={class:"modal-body text-center"},St={key:0,class:"qr-code-container mb-3"},At={key:1,class:"qr-code-container mb-3"},Mt=["src"],$t={class:"mt-2"},Rt={class:"text-muted"},Ft={key:2,class:"qr-code-container mb-3"},Qt={class:"d-flex gap-2 justify-content-center"},Vt=["disabled"],qt=["disabled"],Ut={class:"modal-content"},Dt={class:"modal-header"},Et={class:"modal-title"},Lt={class:"modal-body"},jt={key:0,class:"text-center"},Bt={key:1,class:"text-center"},It={class:"mb-3"},Nt={class:"row"},Pt={class:"col-12"},Ot={class:"info-item"},zt={class:"fw-bold"},Wt={class:"mt-3"},Gt=["disabled"],Ht={key:2,class:"alert alert-warning"},Jt=Ae({__name:"TablesManagementView",setup(Kt){const Z=Re(),ee=Me(),o=d([]),w=d([]),$=d(!1),J=d(!1),R=d(""),F=d(""),Q=d(!1),P=d(!1),O=d(!1),z=d(!1),y=d({number:1,seats:4,location_id:0,description:"",is_active:!0}),V=d(!1),h=d(""),v=d({}),S=d(null),q=d(!1),x=d(""),b=d(null),m=d(null),W=d(!1),k=d(null),G=d(!1),U=d(!1),c=d([]),se=j(()=>Array.isArray(o.value)?o.value.filter(t=>t.is_active&&!t.is_occupied).length:0),te=j(()=>Array.isArray(o.value)?o.value.filter(t=>!t.is_active).length:0),le=j(()=>Array.isArray(o.value)?o.value.filter(t=>t.is_occupied).length:0),oe=j(()=>Array.isArray(o.value)?o.value.filter(t=>{const s=!R.value||D(t)===R.value,f=!F.value||t.location_id.toString()===F.value;return s&&f}):[]),K=t=>new Date(t).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),D=t=>t.is_active?t.is_occupied?"occupied":"available":"inactive",ae=t=>({available:"Доступен",occupied:"Занят",inactive:"Неактивен"})[t]||t,ie=t=>{const s=w.value.find(f=>f.id===t);return s?s.name:`Локация ${t}`},ne=t=>({available:"bg-success",occupied:"bg-danger",inactive:"bg-secondary"})[t]||"bg-secondary",re=t=>{const s=D(t);return t.is_active?{available:"table-available",occupied:"table-occupied"}[s]||"":"table-inactive"},de=t=>({synced:"Синхронизирован",pending:"Ожидает синхронизации",failed:"Ошибка синхронизации",in_progress:"Синхронизация в процессе"})[t]||t,ce=t=>({synced:"bg-success",pending:"bg-warning",failed:"bg-danger",in_progress:"bg-info"})[t]||"bg-secondary",ue=async()=>{try{J.value=!0;const t=await u.getLocations();w.value=t.locations||t}catch(t){console.error("Failed to load locations:",t),w.value=[]}finally{J.value=!1}},A=async()=>{try{$.value=!0;const t=await u.getTables();o.value=t.tables||t}catch(t){console.error("Failed to load tables:",t),o.value=[]}finally{$.value=!1}},E=()=>{Q.value=!1,h.value="",y.value={number:1,seats:4,location_id:0,description:"",is_active:!0}},ve=async()=>{try{V.value=!0,h.value="";const t=await u.createTable(y.value);Array.isArray(o.value)?o.value.push(t):o.value=[t],E()}catch(t){console.error("Failed to create table:",t),t instanceof Error?h.value=t.message:h.value="Произошла неизвестная ошибка"}finally{V.value=!1}},be=t=>{S.value=t.id,v.value={number:t.number,seats:t.seats,location_id:t.location_id,description:t.description||"",is_active:t.is_active},P.value=!0},L=()=>{P.value=!1,x.value="",v.value={},S.value=null},me=async()=>{if(!(!S.value||!Array.isArray(o.value)))try{q.value=!0,x.value="";const t=await u.updateTable(S.value,v.value),s=o.value.findIndex(f=>f.id===S.value);s!==-1&&(o.value[s]=t),L()}catch(t){console.error("Failed to update table:",t),t instanceof Error?x.value=t.message:x.value="Произошла неизвестная ошибка"}finally{q.value=!1}},pe=async t=>{b.value=t,O.value=!0;try{W.value=!0,m.value=await u.getTableQR(t.id)}catch(s){console.error("Failed to load QR code:",s),m.value=null}finally{W.value=!1}},X=()=>{O.value=!1,b.value=null,m.value=null},ye=async()=>{if(!(!b.value||!m.value))try{const t=document.createElement("a");t.href=m.value.qr_code_url,t.download=`table-${b.value.number}-qr.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(t){console.error("Failed to download QR code:",t)}},fe=()=>{if(!b.value||!m.value)return;const t=window.open("","_blank");t&&(t.document.write(`
      <html>
        <head>
          <title>QR-код столика ${b.value.number}</title>
          <style>
            body { text-align: center; padding: 20px; font-family: Arial, sans-serif; }
            img { max-width: 300px; }
            h1 { margin-bottom: 20px; }
            p { margin-top: 20px; color: #666; }
          </style>
        </head>
        <body>
          <h1>Столик ${b.value.number}</h1>
          <img src="${m.value.qr_code_url}" alt="QR код">
          <p>Отсканируйте QR-код для доступа к меню</p>
          <p>QR-код: ${m.value.qr_code}</p>
        </body>
      </html>
    `),t.document.close(),t.print())},ge=async t=>{if(Array.isArray(o.value))try{const s=!t.is_occupied,f=await u.updateTableStatus(t.id,s),l=o.value.findIndex(g=>g.id===t.id);l!==-1&&(o.value[l]=f)}catch(s){console.error("Failed to toggle table occupancy:",s)}},_e=async t=>{if(Array.isArray(o.value))try{const s=!t.is_active,f=await u.updateTable(t.id,{is_active:s}),l=o.value.findIndex(g=>g.id===t.id);l!==-1&&(o.value[l]=f)}catch(s){console.error("Failed to toggle table status:",s)}},ke=async t=>{b.value=t,z.value=!0;try{G.value=!0,k.value=await u.getTableSyncStatus(t.id)}catch(s){console.error("Failed to get sync status:",s),k.value=null}finally{G.value=!1}},Y=()=>{z.value=!1,b.value=null,k.value=null},we=async()=>{if(b.value)try{U.value=!0;const t=await u.forceTableSync(b.value.id);k.value={sync_status:t.sync_status,last_sync:new Date().toISOString()},alert(t.message||"Синхронизация выполнена успешно")}catch(t){console.error("Failed to force sync:",t),alert("Ошибка при выполнении синхронизации")}finally{U.value=!1}},he=async t=>{if(confirm(`Вы уверены, что хотите принудительно синхронизировать столик ${t.number}?`))try{const s=await u.forceTableSync(t.id);alert(s.message||"Синхронизация выполнена успешно"),await A()}catch(s){console.error("Failed to force sync:",s),alert("Ошибка при выполнении синхронизации")}},xe=async t=>{if(Array.isArray(o.value)&&confirm(`Вы уверены, что хотите удалить столик ${t.number}?`))try{await u.deleteTable(t.id),o.value=o.value.filter(s=>s.id!==t.id)}catch(s){console.error("Failed to delete table:",s)}},Ce=async()=>{if(c.value.length&&confirm(`Вы уверены, что хотите активировать ${c.value.length} столиков?`))try{const t=c.value.map(s=>u.updateTable(s,{is_active:!0}));await Promise.all(t),await A(),c.value=[]}catch(t){console.error("Failed to bulk activate tables:",t),alert("Ошибка при активации столиков")}},Te=async()=>{if(c.value.length&&confirm(`Вы уверены, что хотите деактивировать ${c.value.length} столиков?`))try{const t=c.value.map(s=>u.updateTable(s,{is_active:!1}));await Promise.all(t),await A(),c.value=[]}catch(t){console.error("Failed to bulk deactivate tables:",t),alert("Ошибка при деактивации столиков")}},Se=async()=>{if(c.value.length&&confirm(`Вы уверены, что хотите удалить ${c.value.length} столиков? Это действие нельзя отменить.`))try{const t=c.value.map(s=>u.deleteTable(s));await Promise.all(t),await A(),c.value=[]}catch(t){console.error("Failed to bulk delete tables:",t),alert("Ошибка при удалении столиков")}};return $e(async()=>{if(!ee.isAuthenticated){Z.push("/login");return}await Promise.all([ue(),A()])}),(t,s)=>{const f=Ve("router-link");return r(),n("div",Ue,[e("div",De,[e("div",Ee,[e("div",Le,[e("nav",je,[e("ol",Be,[e("li",Ie,[Fe(f,{to:"/dashboard",class:"text-decoration-none text-dark"},{default:Qe(()=>s[19]||(s[19]=[e("i",{class:"bi bi-house me-1"},null,-1),a(" Главная ")])),_:1,__:[19]})]),s[20]||(s[20]=e("li",{class:"breadcrumb-item active text-muted","aria-current":"page"},"Управление столиками",-1))])]),e("div",Ne,[e("div",Pe,[s[25]||(s[25]=e("h1",{class:"h2 mb-2 d-flex align-items-center"},[e("i",{class:"bi bi-table me-2 text-primary"}),a(" Управление столиками ")],-1)),e("p",Oe,[s[21]||(s[21]=a(" Всего столиков: ")),e("span",ze,i(Array.isArray(o.value)?o.value.length:0),1),s[22]||(s[22]=a(" • Активных: ")),e("span",We,i(se.value),1),s[23]||(s[23]=a(" • Неактивных: ")),e("span",Ge,i(te.value),1),s[24]||(s[24]=a(" • Занятых: ")),e("span",He,i(le.value),1)])]),e("div",Je,[e("button",{onClick:s[0]||(s[0]=l=>Q.value=!0),class:"btn btn-primary fs-5",disabled:$.value},s[26]||(s[26]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Добавить столик ")]),8,Ke)])])])])]),e("div",Xe,[e("div",Ye,[e("div",Ze,[e("div",es,[e("div",ss,[e("div",ts,[s[32]||(s[32]=e("div",{class:"col-md-4"},[e("h5",{class:"mb-0"},[e("i",{class:"bi bi-table me-2"}),a(" Список столиков ")])],-1)),e("div",ls,[e("div",os,[c.value.length>0?(r(),n("div",as,[e("button",{class:"btn btn-outline-primary",onClick:Ce,title:`Активировать ${c.value.length} столиков`},[s[27]||(s[27]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),a(" Активировать ("+i(c.value.length)+") ",1)],8,is),e("button",{class:"btn btn-outline-secondary",onClick:Te,title:`Деактивировать ${c.value.length} столиков`},[s[28]||(s[28]=e("i",{class:"bi bi-x-circle me-1"},null,-1)),a(" Деактивировать ("+i(c.value.length)+") ",1)],8,ns),e("button",{class:"btn btn-outline-danger",onClick:Se,title:`Удалить ${c.value.length} столиков`},[s[29]||(s[29]=e("i",{class:"bi bi-trash me-1"},null,-1)),a(" Удалить ("+i(c.value.length)+") ",1)],8,rs)])):_("",!0),e("div",ds,[p(e("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>R.value=l),class:"form-select form-select-sm"},s[30]||(s[30]=[e("option",{value:""},"Все статусы",-1),e("option",{value:"available"},"Доступные",-1),e("option",{value:"occupied"},"Занятые",-1),e("option",{value:"inactive"},"Неактивные",-1)]),512),[[B,R.value]]),p(e("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>F.value=l),class:"form-select form-select-sm"},[s[31]||(s[31]=e("option",{value:""},"Все локации",-1)),(r(!0),n(I,null,N(w.value,l=>(r(),n("option",{key:l.id,value:l.id.toString()},i(l.name),9,cs))),128))],512),[[B,F.value]])])])])])]),e("div",us,[$.value?(r(),n("div",vs,s[33]||(s[33]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Загрузка...")],-1),e("p",{class:"text-muted mt-2"},"Загрузка столиков...",-1)]))):!Array.isArray(o.value)||o.value.length===0?(r(),n("div",bs,[s[35]||(s[35]=e("i",{class:"bi bi-table text-muted",style:{"font-size":"3rem"}},null,-1)),s[36]||(s[36]=e("p",{class:"text-muted mt-3"},"Столики не найдены",-1)),e("button",{onClick:s[3]||(s[3]=l=>Q.value=!0),class:"btn btn-primary"},s[34]||(s[34]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Добавить первый столик ")]))])):(r(),n("div",ms,[(r(!0),n(I,null,N(oe.value,l=>(r(),n("div",{key:l.id,class:"col-lg-3 col-md-4 col-sm-6 mb-3"},[e("div",{class:M(["card border-0 shadow-sm table-card",re(l)])},[e("div",ps,[e("div",ys,[e("div",fs,[p(e("input",{class:"form-check-input",type:"checkbox",id:`table-${l.id}`,"onUpdate:modelValue":s[4]||(s[4]=g=>c.value=g),value:l.id},null,8,gs),[[H,c.value]])]),s[37]||(s[37]=e("i",{class:"bi bi-table me-2"},null,-1)),e("strong",_s,"Столик "+i(l.number),1)]),e("span",{class:M(["badge badge-sm",ne(D(l))])},i(ae(D(l))),3)]),e("div",ks,[e("div",ws,[e("div",hs,[e("div",xs,[s[38]||(s[38]=e("i",{class:"bi bi-people-fill text-primary me-1"},null,-1)),e("span",Cs,i(l.seats),1),s[39]||(s[39]=e("small",{class:"text-muted ms-1"},"мест",-1))])]),e("div",Ts,[e("div",Ss,[s[40]||(s[40]=e("i",{class:"bi bi-geo-alt-fill text-success me-1"},null,-1)),e("small",As,i(ie(l.location_id)),1)])])]),l.current_order_id?(r(),n("div",Ms,[e("div",$s,[e("div",Rs,[s[41]||(s[41]=e("i",{class:"bi bi-receipt me-1"},null,-1)),e("small",Fs,"Заказ #"+i(l.current_order_id),1)])])])):_("",!0),l.description?(r(),n("div",Qs,[e("div",Vs,[e("small",qs,i(l.description),1)])])):_("",!0)]),e("div",Us,[e("div",Ds,[e("button",{class:"btn btn-sm btn-outline-primary flex-fill",onClick:g=>pe(l),title:"QR-код столика "+l.number},s[42]||(s[42]=[e("i",{class:"bi bi-qr-code"},null,-1)]),8,Es),e("button",{class:"btn btn-sm btn-outline-secondary flex-fill",onClick:g=>be(l),title:"Редактировать столик "+l.number},s[43]||(s[43]=[e("i",{class:"bi bi-pencil"},null,-1)]),8,Ls),e("button",{class:M(["btn btn-sm flex-fill",l.is_occupied?"btn-outline-success":"btn-outline-warning"]),onClick:g=>ge(l),title:l.is_occupied?"Освободить столик":"Занять столик"},[e("i",{class:M(["bi",l.is_occupied?"bi-person-dash":"bi-person-plus"])},null,2)],10,js),e("div",Bs,[s[49]||(s[49]=e("button",{class:"btn btn-sm btn-outline-secondary dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown",title:"Дополнительные действия"},[e("i",{class:"bi bi-three-dots"})],-1)),e("ul",Is,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:g=>ke(l)},s[44]||(s[44]=[e("i",{class:"bi bi-arrow-clockwise me-2"},null,-1),a(" Статус синхронизации ")]),8,Ns)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:g=>he(l)},s[45]||(s[45]=[e("i",{class:"bi bi-cloud-arrow-up me-2"},null,-1),a(" Принудительная синхронизация ")]),8,Ps)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:g=>_e(l)},[s[46]||(s[46]=e("i",{class:"bi bi-toggle-on me-2"},null,-1)),a(" "+i(l.is_active?"Деактивировать":"Активировать"),1)],8,Os)]),s[48]||(s[48]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("a",{class:"dropdown-item text-danger",href:"#",onClick:g=>xe(l)},s[47]||(s[47]=[e("i",{class:"bi bi-trash me-2"},null,-1),a(" Удалить ")]),8,zs)])])])]),e("div",Ws,[e("small",Gs,[s[50]||(s[50]=e("i",{class:"bi bi-clock me-1"},null,-1)),a(" "+i(K(l.updated_at)),1)])])])],2)]))),128))]))])])])])]),Q.value?(r(),n("div",{key:0,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"},onClick:E},[e("div",{class:"modal-dialog modal-dialog-centered modal-lg",onClick:s[10]||(s[10]=C(()=>{},["stop"]))},[e("div",Hs,[e("div",{class:"modal-header"},[s[51]||(s[51]=e("h5",{class:"modal-title"},[e("i",{class:"bi bi-plus-circle me-2"}),a(" Добавить столик ")],-1)),e("button",{type:"button",class:"btn-close",onClick:E})]),e("div",Js,[h.value?(r(),n("div",Ks,[e("pre",Xs,i(h.value),1)])):_("",!0),e("form",{onSubmit:C(ve,["prevent"])},[e("div",Ys,[e("div",Zs,[s[52]||(s[52]=e("label",{class:"form-label"},"Номер столика",-1)),p(e("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>y.value.number=l),type:"number",class:"form-control",min:"1",required:"",placeholder:"1"},null,512),[[T,y.value.number,void 0,{number:!0}]])]),e("div",et,[s[53]||(s[53]=e("label",{class:"form-label"},"Количество мест",-1)),p(e("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>y.value.seats=l),type:"number",class:"form-control",min:"1",max:"20",required:"",placeholder:"4"},null,512),[[T,y.value.seats,void 0,{number:!0}]])]),e("div",st,[s[55]||(s[55]=e("label",{class:"form-label"},"Локация",-1)),p(e("select",{"onUpdate:modelValue":s[7]||(s[7]=l=>y.value.location_id=l),class:"form-select",required:""},[s[54]||(s[54]=e("option",{value:"0"},"Выберите локацию",-1)),(r(!0),n(I,null,N(w.value,l=>(r(),n("option",{key:l.id,value:l.id},i(l.name),9,tt))),128))],512),[[B,y.value.location_id,void 0,{number:!0}]])]),e("div",lt,[s[56]||(s[56]=e("label",{class:"form-label"},"Описание",-1)),p(e("textarea",{"onUpdate:modelValue":s[8]||(s[8]=l=>y.value.description=l),class:"form-control",rows:"3",placeholder:"Дополнительная информация о столике"},null,512),[[T,y.value.description]])]),e("div",ot,[e("div",at,[p(e("input",{"onUpdate:modelValue":s[9]||(s[9]=l=>y.value.is_active=l),class:"form-check-input",type:"checkbox",id:"createActive"},null,512),[[H,y.value.is_active]]),s[57]||(s[57]=e("label",{class:"form-check-label",for:"createActive"}," Активен ",-1))])])]),e("div",it,[e("button",{type:"button",onClick:E,class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",class:"btn btn-primary",disabled:V.value},[s[58]||(s[58]=e("i",{class:"bi bi-plus-circle me-1"},null,-1)),a(" "+i(V.value?"Создание...":"Создать"),1)],8,nt)])],32)])])])])):_("",!0),P.value?(r(),n("div",{key:1,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"},onClick:L},[e("div",{class:"modal-dialog modal-dialog-centered modal-lg",onClick:s[16]||(s[16]=C(()=>{},["stop"]))},[e("div",rt,[e("div",{class:"modal-header"},[s[59]||(s[59]=e("h5",{class:"modal-title"},[e("i",{class:"bi bi-pencil me-2"}),a(" Редактировать столик ")],-1)),e("button",{type:"button",class:"btn-close",onClick:L})]),e("div",dt,[x.value?(r(),n("div",ct,[e("pre",ut,i(x.value),1)])):_("",!0),e("form",{onSubmit:C(me,["prevent"])},[e("div",vt,[e("div",bt,[s[60]||(s[60]=e("label",{class:"form-label"},"Номер столика",-1)),p(e("input",{"onUpdate:modelValue":s[11]||(s[11]=l=>v.value.number=l),type:"number",class:"form-control",min:"1",required:""},null,512),[[T,v.value.number,void 0,{number:!0}]])]),e("div",mt,[s[61]||(s[61]=e("label",{class:"form-label"},"Количество мест",-1)),p(e("input",{"onUpdate:modelValue":s[12]||(s[12]=l=>v.value.seats=l),type:"number",class:"form-control",min:"1",max:"20",required:""},null,512),[[T,v.value.seats,void 0,{number:!0}]])]),e("div",pt,[s[62]||(s[62]=e("label",{class:"form-label"},"Локация",-1)),p(e("select",{"onUpdate:modelValue":s[13]||(s[13]=l=>v.value.location_id=l),class:"form-select",required:""},[(r(!0),n(I,null,N(w.value,l=>(r(),n("option",{key:l.id,value:l.id},i(l.name),9,yt))),128))],512),[[B,v.value.location_id,void 0,{number:!0}]])]),e("div",ft,[s[63]||(s[63]=e("label",{class:"form-label"},"Описание",-1)),p(e("textarea",{"onUpdate:modelValue":s[14]||(s[14]=l=>v.value.description=l),class:"form-control",rows:"3"},null,512),[[T,v.value.description]])]),e("div",gt,[e("div",_t,[p(e("input",{"onUpdate:modelValue":s[15]||(s[15]=l=>v.value.is_active=l),class:"form-check-input",type:"checkbox",id:"editActive"},null,512),[[H,v.value.is_active]]),s[64]||(s[64]=e("label",{class:"form-check-label",for:"editActive"}," Активен ",-1))])])]),e("div",kt,[e("button",{type:"button",onClick:L,class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",class:"btn btn-primary",disabled:q.value},[s[65]||(s[65]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),a(" "+i(q.value?"Сохранение...":"Сохранить"),1)],8,wt)])],32)])])])])):_("",!0),O.value?(r(),n("div",{key:2,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"},onClick:X},[e("div",{class:"modal-dialog modal-dialog-centered",onClick:s[17]||(s[17]=C(()=>{},["stop"]))},[e("div",ht,[e("div",xt,[e("h5",Ct,[s[66]||(s[66]=e("i",{class:"bi bi-qr-code me-2"},null,-1)),a(" QR-код для столика "+i(b.value?.number),1)]),e("button",{type:"button",class:"btn-close",onClick:X})]),e("div",Tt,[W.value?(r(),n("div",St,s[67]||(s[67]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Загрузка QR-кода...")],-1)]))):m.value?(r(),n("div",At,[e("img",{src:m.value.qr_code_url,alt:"QR код",class:"img-fluid",style:{"max-width":"300px"}},null,8,Mt),e("div",$t,[e("small",Rt,"QR-код: "+i(m.value.qr_code),1)])])):(r(),n("div",Ft,s[68]||(s[68]=[e("div",{class:"alert alert-warning"},[e("i",{class:"bi bi-exclamation-triangle me-2"}),a(" Не удалось загрузить QR-код ")],-1)]))),s[71]||(s[71]=e("p",{class:"text-muted mb-3"}," Отсканируйте QR-код для доступа к меню столика ",-1)),e("div",Qt,[e("button",{class:"btn btn-primary",onClick:ye,disabled:!m.value},s[69]||(s[69]=[e("i",{class:"bi bi-download me-1"},null,-1),a(" Скачать ")]),8,Vt),e("button",{class:"btn btn-outline-primary",onClick:fe,disabled:!m.value},s[70]||(s[70]=[e("i",{class:"bi bi-printer me-1"},null,-1),a(" Печать ")]),8,qt)])])])])])):_("",!0),z.value?(r(),n("div",{key:3,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"},onClick:Y},[e("div",{class:"modal-dialog modal-dialog-centered",onClick:s[18]||(s[18]=C(()=>{},["stop"]))},[e("div",Ut,[e("div",Dt,[e("h5",Et,[s[72]||(s[72]=e("i",{class:"bi bi-arrow-clockwise me-2"},null,-1)),a(" Статус синхронизации столика "+i(b.value?.number),1)]),e("button",{type:"button",class:"btn-close",onClick:Y})]),e("div",Lt,[G.value?(r(),n("div",jt,s[73]||(s[73]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Загрузка статуса...")],-1)]))):k.value?(r(),n("div",Bt,[e("div",It,[e("span",{class:M(["badge fs-6",ce(k.value.sync_status)])},i(de(k.value.sync_status)),3)]),e("div",Nt,[e("div",Pt,[e("div",Ot,[s[75]||(s[75]=e("i",{class:"bi bi-clock text-info"},null,-1)),e("div",null,[s[74]||(s[74]=e("small",{class:"text-muted"},"Последняя синхронизация",-1)),e("div",zt,i(K(k.value.last_sync)),1)])])])]),e("div",Wt,[e("button",{class:"btn btn-primary",onClick:we,disabled:U.value},[s[76]||(s[76]=e("i",{class:"bi bi-cloud-arrow-up me-1"},null,-1)),a(" "+i(U.value?"Синхронизация...":"Принудительная синхронизация"),1)],8,Gt)])])):(r(),n("div",Ht,s[77]||(s[77]=[e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1),a(" Не удалось загрузить статус синхронизации ")])))])])])])):_("",!0)])}}}),Yt=qe(Jt,[["__scopeId","data-v-6b123277"]]);export{Yt as default};
